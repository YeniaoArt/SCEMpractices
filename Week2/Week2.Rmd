---
title: "Week2"
output: html_document
date: "2025-10-01"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

#Part I: Data wrangling
Load packages

```{r}
library(dplyr)
library(nycflights13) # For the NYC flight data
library(gapminder) # For global socio-economic data
```

1. Data Wrangling
```{r}
#1.1 Select and Filter
large_delays_JFK <- flights %>%
  filter(origin == 'JFK' & dep_delay >= 60) %>%
  select(year, month, day, dep_delay, arr_delay, carrier)

head(large_delays_JFK, 5)

print(nrow(large_delays_JFK))
print(ncol(large_delays_JFK))
```
```{r}
#1.2 Arrange
head(large_delays_JFK %>% arrange(desc(arr_delay)), 5)
```
```{r}
#1.3 Join and Rename
airline_lookup <- data.frame(
carrier = c("AA", "DL", "UA", "B6", "WN"),
airline_name = c("American Airlines", "Delta", "United Airlines",
"JetBlue", "Southwest Airlines"))

X <- left_join(airline_lookup, large_delays_JFK)
X

Y <- X %>%
  rename(airline = airline_name) %>%
  select(airline, dep_delay, arr_delay)

print(head(Y, 7))
```
```{r}
#1.4 Mutate
#large_delays_JFK %>% 
Z <- X %>% 
  mutate(delay_radio = arr_delay / dep_delay)

Z %>% 
  select(airline_name, delay_radio) %>%
  arrange(desc(delay_radio))

```
```{r}
#1.5 Summarise and Group By
Z

G <- Z %>%
  group_by(airline_name) %>%
  summarise(n_flights=n(), avg_dep_delay=mean(dep_delay, na.rm=TRUE), median_arr_delay=median(arr_delay, na.rm=TRUE), max_delay_ratio=max(delay_radio, na.rm=TRUE))
G

Num_NAs <- G %>% summarize(across(everything(), ~sum(is.na(.x))))
print(Num_NAs)
```
#Part II: A quick recap of probability
```{r}
df <- data.frame(x=1:5,y=6:10)
df %>%
  select(x)

df

```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
